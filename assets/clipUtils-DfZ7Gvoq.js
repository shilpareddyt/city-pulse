const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/intersectsOperator-CnntnR2o.js","assets/ProjectionTransformation-CM87fAmS.js","assets/Envelope2D-DM-TR0g7.js","assets/Point2D-DKT_pVCB.js","assets/Transformation2D-BY72LdYb.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/index-CLxXbLZV.js","assets/index-q51HPNg-.css","assets/OperatorDefinitions-DP7_WWTp.js","assets/jsonConverter-DGz1L-SH.js","assets/OperatorIntersects-CLCtr4KH.js","assets/apiConverter-DpT3hsST.js","assets/containsOperator-De0ymsEF.js"])))=>i.map(i=>d[i]);
import{_ as O,A as $,cs as b,bC as L}from"./index-CLxXbLZV.js";import{c as A}from"./dataUtils-3WryPmNa.js";function V(e,r){if(e.spatialReference.equals(r))return e;const t=b(e.spatialReference),i=b(r);if(t===i)return e;const a=t/i;return{x:e.x*a,y:e.y*a}}async function K(e,r,t){if(t.type==="extent")return B(e,r,t);const{width:i,height:a}=e,n=new Uint8Array(i*a);return(await O(async()=>{const{execute:h}=await import("./intersectsOperator-CnntnR2o.js").then(x=>x.i);return{execute:h}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))).execute(r,t)?t.type==="polyline"?F(e,r,t):(await O(async()=>{const{execute:h}=await import("./containsOperator-De0ymsEF.js").then(x=>x.c);return{execute:h}},__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,11]))).execute(t,r)?e:j(e,r,t):new A({pixelType:e.pixelType,width:i,height:a,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function j(e,r,t){if(!e)return e;const{width:i,height:a}=e,n=q({geometry:t,size:[i,a],srcExtent:r,srcMask:e.mask});return new A({pixelType:e.pixelType,width:i,height:a,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function q(e){const{geometry:r,size:t,srcExtent:i,srcMask:a}=e,[n,h]=t;let x;const m=i.width/n,u=i.height/h,{xmin:s,ymax:o}=i;if(r.type==="extent"){const f=(r.xmin-s)/m,p=(r.xmax-s)/m,c=(o-r.ymax)/u,y=(o-r.ymin)/u;x=[[[f,c],[f,y],[p,y],[p,c],[f,c]]]}else x=r.rings.map(f=>f.map(([p,c])=>[(p-s)/m,(o-c)/u]));return Z(x,t,a)}function Z(e,r,t){const[i,a]=r,n=new OffscreenCanvas(i,a).getContext("2d");n.fillStyle="#f00",n.beginPath(),e.forEach(s=>{n.moveTo(s[0][0],s[0][1]);for(let o=0;o<s.length;o++)n.lineTo(s[o][0],s[o][1]);n.closePath()}),n.fill();const h=n.getImageData(0,0,i,a).data,x=i*a,m=new Uint8Array(x);let u=!1;for(let s=0;s<x;s++)t&&!t[s]||(h[4*s+3]>127?m[s]=255:u=!0);return u||t?m:void 0}function B(e,r,t){const{width:i,height:a}=e,n=new Uint8Array(i*a),h=r.width/i,x=r.height/a;if(t.width/h<.5||t.height/x<.5)return new A({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});const{xmin:m,xmax:u,ymin:s,ymax:o}=r,{xmin:f,xmax:p,ymin:c,ymax:y}=t,l=Math.max(m,f),R=Math.min(u,p),g=Math.max(s,c),M=Math.min(o,y),w=.5*h,E=.5*x;if(R-l<w||M-g<E||R<m+w||l>u-w||g>o-E||M<s+E)return new A({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});const d=Math.max(0,(l-m)/h),z=Math.min(i,Math.max(0,(R-m)/h)),P=Math.max(0,(o-M)/x),_=Math.min(a,Math.max(0,(o-g)/x)),T=Math.round(d),v=Math.round(z)-1,k=Math.round(P),I=Math.round(_)-1;if(T===v&&d%1>.5&&z%1<.5||k===I&&P%1>.5&&_%1<.5)return new A({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]});if(T===0&&k===0&&v===i&&I===a)return e;const C=e.mask;for(let S=k;S<=I;S++)for(let U=T;U<=v;U++){const D=S*i+U;n[D]=C?C[D]:255}return new A({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]})}function F(e,r,t){const{width:i,height:a}=e,n=new Uint8Array(i*a),h=r.width/i,x=r.height/a,{xmin:m,ymax:u}=r,{paths:s}=t,o=e.mask;for(let f=0;f<s.length;f++){const p=s[f];for(let c=0;c<p.length-1;c++){const[y,l]=p[c],[R,g]=p[c+1];let M=Math.floor((u-l)/x),w=Math.floor((u-g)/x);if(w<M){const d=M;M=w,w=d}M=Math.max(0,M),w=Math.min(a-1,w);const E=(R-y)/(g-l);for(let d=M;d<=w;d++){const z=d===M?Math.max(l,g):(a+1-d)*x,P=d===w?Math.min(l,g):z-x;let _=Math.floor(g===l?(y-m)/h:(E*(z-l)+y-m)/h),T=Math.floor(g===l?(R-m)/h:(E*(P-l)+y-m)/h);if(T<_){const k=_;_=T,T=k}const v=d*i;_=Math.max(0,_),T=Math.min(i-1,T);for(let k=v+_;k<=v+T;k++)n[k]=o?o[k]:255}}}return new A({pixelType:e.pixelType,width:i,height:a,mask:n,pixels:[...e.pixels]})}function N(e,r){const{extent:t}=G(e,r,new L({x:e.pixelSize.x,y:e.pixelSize.y,spatialReference:e.spatialReference})),{extent:i}=e.extent;if(t.xmax=Math.min(t.xmax,i.xmax),t.ymax=Math.min(t.ymax,i.ymax),t.xmin<t.xmax&&t.ymin<t.ymax){const{x:a,y:n}=e.pixelSize,h=Math.round(t.width/a),x=Math.round(t.height/n);e.extent=t,e.width=h,e.height=x}}function G(e,r,t,i=!0){const{spatialReference:a}=e,{x:n,y:h}=V(t,a);let x,m,u;const s=r.type==="extent"?r:r.extent;let{xmin:o,xmax:f,ymax:p,ymin:c}=s;const{xmin:y,ymax:l}=e.extent;return i?(o=y+(o>y?n*Math.round((o-y)/n):0),p=l-(p<l?h*Math.round((l-p)/h):0),f=y+(f>y?n*Math.round((f-y)/n):0),c=l-(c<l?h*Math.round((l-c)/h):0),x=new $({xmin:o,ymax:p,xmax:f,ymin:c,spatialReference:a}),m=Math.round(x.width/n),u=Math.round(x.height/h)):(m=Math.floor((f-o)/n+.8),u=Math.floor((p-c)/h+.8),o=y+(o>y?n*Math.floor((o-y)/n+.1):0),p=l-(p<l?h*Math.floor((l-p)/h+.1):0),f=o+m*n,c=p-u*h,x=new $({xmin:o,ymax:p,xmax:f,ymin:c,spatialReference:a})),{extent:x,width:m,height:u}}export{N as l,G as p,K as r,q as x};
