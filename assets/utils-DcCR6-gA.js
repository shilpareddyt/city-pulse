const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-BzqMLeFk.js","assets/index-Cyz3pbfr.js","assets/index-q51HPNg-.css"])))=>i.map(i=>d[i]);
import{e2 as w,ax as a,hk as y,hl as h,hm as d,hn as k,ho as g,_ as L}from"./index-Cyz3pbfr.js";import{u as z}from"./cimSymbolUtils-BQ3E2dUg.js";new w(1e3);new a([128,128,128]);const x=new a("white");function J(n){if(n==null||!("symbolLayers"in n)||n.symbolLayers==null)return!1;switch(n.type){case"point-3d":return n.symbolLayers.some(o=>o.type==="object");case"line-3d":return n.symbolLayers.some(o=>o.type==="path");case"polygon-3d":return n.symbolLayers.some(o=>o.type==="object"||o.type==="extrude");default:return!1}}function M(n){return n.resource?.href??""}function N(n,o){if(!n)return null;let l=null;return y(n)?l=_(n):h(n)&&(l=n.type==="cim"?z(n):n.color?new a(n.color):null),l?f(l,o):null}function _(n){const o=n.symbolLayers;if(!o)return null;let l=null;return o.forEach(t=>{t.type==="object"&&t.resource?.href||(l=t.type==="water"?t.color:t.material?t.material.color:null)}),l?new a(l):null}function f(n,o){if(o==null||n==null)return n;const l=n.toRgba();return l[3]=l[3]*o,new a(l)}function j(n,o,l){const t=n.symbolLayers;if(!t)return;const e=r=>f(o??r??(l!=null?x:null),l);t.forEach(r=>{if(r.type!=="object"||!r.resource?.href||o)if(r.type==="water")r.color=e(r.color);else{const c=r.material!=null?r.material.color:null,u=e(c);if(r.material==null?r.material=new d({color:u}):r.material.color=u,l!=null&&"outline"in r&&r.outline?.color!=null&&(r.outline.color=f(r.outline.color,l)),"marker"in r&&r.marker!=null){const i=e(r.marker.color);r.marker.color=i}}})}function v(n,o,l){(o=o??n.color)&&(n.color=f(o,l)),l!=null&&"outline"in n&&n.outline?.color&&(n.outline.color=f(n.outline.color,l))}function T(n,o,l){n&&(o||l!=null)&&(o&&(o=new a(o)),y(n)?j(n,o,l):h(n)&&v(n,o,l))}async function S(n,o){const l=n.symbolLayers;l&&await k(l,async t=>E(t,o))}async function E(n,o){switch(n.type){case"extrude":$(n,o);break;case"icon":case"line":case"text":R(n,o);break;case"path":A(n,o);break;case"object":await O(n,o)}}function R(n,o){const l=p(o);l!=null&&(n.size=l)}function p(n){for(const o of n)if(typeof o=="number")return o;return null}function $(n,o){const l=o[2];typeof l=="number"&&(n.size=l)}async function O(n,o){const{resourceSize:l,symbolSize:t}=await D(n),e=b(o,l,t);e!=null&&(n.width=s(o[0],t[0],l[0],e),n.depth=s(o[1],t[1],l[1],e),n.height=s(o[2],t[2],l[2],e))}function A(n,o){const l=b(o,g,[n.width,void 0,n.height]);l!=null&&(n.width=s(o[0],n.width,1,l),n.height=s(o[2],n.height,1,l))}function b(n,o,l){for(let t=0;t<3;t++){const e=n[t];switch(e){case"symbol-value":{const r=l[t];return r!=null?r/o[t]:1}case"proportional":break;default:if(e&&o[t])return e/o[t]}}return null}async function D(n){const{computeObjectLayerResourceSize:o}=await L(()=>import("./symbolLayerUtils-BzqMLeFk.js"),__vite__mapDeps([0,1,2])),l=await o(n,10),{width:t,height:e,depth:r}=n,c=[t,r,e];let u=1;for(let i=0;i<3;i++){const m=c[i];if(m!=null){u=m/l[i];break}}for(let i=0;i<3;i++)c[i]==null&&(c[i]=l[i]*u);return{resourceSize:l,symbolSize:c}}function s(n,o,l,t){switch(n){case"proportional":return l*t;case"symbol-value":return o??l;default:return n}}function P(n,o){const l=p(o);if(l!=null)switch(n.type){case"simple-marker":n.size=l;break;case"picture-marker":{const t=n.width/n.height;t>1?(n.width=l,n.height=l*t):(n.width=l*t,n.height=l);break}case"simple-line":n.width=l;break;case"text":n.font.size=l}}async function U(n,o){if(n&&o)return y(n)?S(n,o):void(h(n)&&P(n,o))}function V(n,o,l){if(n&&o!=null)if(y(n)){const t=n.symbolLayers;t&&t.forEach(e=>{if(e.type==="object")switch(l){case"tilt":e.tilt=(e.tilt??0)+o;break;case"roll":e.roll=(e.roll??0)+o;break;default:e.heading=(e.heading??0)+o}e.type==="icon"&&(e.angle+=o)})}else h(n)&&(n.type!=="simple-marker"&&n.type!=="picture-marker"&&n.type!=="text"||(n.angle+=o))}function q(n){return n!=null&&n.type==="polygon-3d"&&n.symbolLayers.some(o=>o.type==="extrude")}export{q as A,T as L,U as M,V as N,M as b,J as h,N as w};
